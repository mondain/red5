<con:tc-config xmlns:con="http://www.terracotta.org/config">
  <servers>
    <server name="localhost">
      <dso-port>9510</dso-port>
      <jmx-port>9520</jmx-port>
      <data>terracotta/server-data</data>
      <logs>terracotta/server-logs</logs>
    </server>
  </servers>
  <clients>
    <logs>terracotta/client-logs</logs>
  </clients>
  <application>
    <dso>
      <instrumented-classes>
        <include>
          <class-expression>org.red5..*</class-expression>
          <honor-transient>true</honor-transient>
        </include>
        <include>
          <class-expression>javax.management..*</class-expression>
          <honor-transient>true</honor-transient>
        </include>
      </instrumented-classes>
      <transient-fields>
        <field-name>org.red5.server.Scope.serviceHandlers</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPMinaConnection.ioSession</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.bwContext</field-name>
        <field-name>org.red5.server.messaging.AbstractPipe.listeners</field-name>
        <field-name>org.red5.server.messaging.AbstractPipe.providers</field-name>
        <field-name>org.red5.server.messaging.AbstractPipe.consumers</field-name>        
        <field-name>org.red5.server.WebScope.servletContext</field-name>
        <field-name>org.red5.server.PersistableAttributeStore.store</field-name>
        <field-name>org.red5.server.AttributeStore.attributes</field-name>
        <field-name>org.red5.server.AttributeStore.hashes</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.waitForHandshakeService</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.waitForHandshakeJob</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.oName</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.keepAliveJobName</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.lastPingSent</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.lastPongReceived</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.lastBytesRead</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.clientBytesRead</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.lastPingTime</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.usedStreams</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.streamBuffers</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.nextBytesRead</field-name>
        <field-name>org.red5.server.BaseConnection.readMessages</field-name>
        <field-name>org.red5.server.BaseConnection.writtenMessages</field-name>
        <field-name>org.red5.server.BaseConnection.droppedMessages</field-name>
        <field-name>org.red5.server.BaseConnection.client</field-name>
        <field-name>org.red5.server.BaseConnection.basicScopes</field-name>
        <field-name>org.red5.server.BaseConnection.scope</field-name>
        <field-name>org.red5.server.stream.AbstractStream.codecInfo</field-name>
        <field-name>org.red5.server.stream.PlaylistSubscriberStream.executor</field-name>
        <field-name>org.red5.server.stream.PlaylistSubscriberStream.bwController</field-name>
        <field-name>org.red5.server.stream.PlaylistSubscriberStream.bwContext</field-name>
        <field-name>org.red5.server.stream.PlaylistSubscriberStream.items</field-name>
        <field-name>org.red5.server.stream.PlaylistSubscriberStream$PlayEngine.schedulingService</field-name>
        <field-name>org.red5.server.stream.PlaylistSubscriberStream$PlayEngine.audioBucket</field-name>
        <field-name>org.red5.server.stream.PlaylistSubscriberStream$PlayEngine.videoBucket</field-name>
        <field-name>org.red5.server.stream.PlaylistSubscriberStream$PlayEngine.lastMessage</field-name>
        <field-name>org.red5.server.stream.PlaylistSubscriberStream$PlayEngine.pullAndPushFuture</field-name>
        <field-name>org.red5.server.stream.PlaylistSubscriberStream$PlayEngine.pendingMessage</field-name>
        <field-name>org.red5.server.stream.AbstractClientStream.conn</field-name>
        <field-name>org.red5.server.stream.provider.FileProvider.reader</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.publishedName</field-name>
        <field-name>org.red5.server.stream.BroadcastScope.compCounter</field-name>
        <field-name>org.red5.server.stream.BroadcastScope.hasRemoved</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.livePipe</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.videoCodecFactory</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.checkVideoCodec</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.firstPacketTime</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.audioTime</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.videoTime</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.dataTime</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.connMsgOut</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.recordPipe</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.recording</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.recordingFilename</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.closed</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.bytesReceived</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.creationTime</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.sendStartNotification</field-name>
        <field-name>org.red5.server.stream.ClientBroadcastStream.recordingFile</field-name>
        <field-name>org.red5.server.Client.oName</field-name>
        <field-name>org.red5.server.so.SharedObjectScope.serverListeners</field-name>
        <field-name>org.red5.server.so.SharedObjectScope.securityHandlers</field-name>
        <field-name>org.red5.server.so.SharedObjectScope.log</field-name>
        <field-name>org.red5.server.net.rtmp.RTMPConnection.deferredResults</field-name>
        <field-name>org.red5.server.so.SharedObject.listeners</field-name>
      </transient-fields>
      <locks>
        <named-lock>
          <method-expression>* org.red5.server.Scope.*etDepth(..)</method-expression>
          <lock-name>ScopeDepth</lock-name>
          <lock-level>write</lock-level>
        </named-lock>
        <named-lock>
          <method-expression>* org.red5.server.Scope.*connect(..)</method-expression>
          <lock-name>ScopeConnections</lock-name>
          <lock-level>write</lock-level>
        </named-lock>
        <named-lock>
          <method-expression>* org.red5.server.webapp.oflaDemo.Application.app*(..)</method-expression>
          <lock-name>oflaDemo</lock-name>
          <lock-level>write</lock-level>
        </named-lock>
        <named-lock>
          <method-expression>* org.red5.server.BasicScope.*EventListener(..)</method-expression>
          <lock-name>ScopeEvents</lock-name>
          <lock-level>write</lock-level>
        </named-lock>
        <named-lock>
          <method-expression>* org.red5.server.service.PendingCall.*Result(..)</method-expression>
          <lock-name>PendingCallResult</lock-name>
          <lock-level>write</lock-level>
        </named-lock>
        <named-lock>
          <method-expression>* org.red5.server.stream.PlaylistSubscriberStream$PlayEngine.*(..)</method-expression>
          <lock-name>PlayEngine</lock-name>
          <lock-level>write</lock-level>
        </named-lock>
        <named-lock>
          <method-expression>* org.red5.server.stream.AbstractClientStream.setClientBufferDuration(..)</method-expression>
          <lock-name>clientBufferDuration</lock-name>
          <lock-level>write</lock-level>
        </named-lock>
      </locks>
    </dso>
    <spring>
      <jee-application name="*">
        <application-contexts>
          <application-context>
            <paths>
              <path>*/red5-default.xml</path>
            </paths>
            <beans>
              <bean name="global.scope"/>
              <bean name="global.context">
                <non-distributed-field>applicationContext</non-distributed-field>
                <non-distributed-field>coreContext</non-distributed-field>
              </bean>
              <bean name="global.handler"/>
              <bean name="global.clientRegistry"/>
              <bean name="global.serviceInvoker"/>
              <bean name="global.mappingStrategy"/>
              <bean name="red5.scopeResolver"/>
              <bean name="red5.server">
                <non-distributed-field>applicationContext</non-distributed-field>
              </bean>
            </beans>
          </application-context>
        </application-contexts>
      </jee-application>
    </spring>
  </application>
  <system>
    <configuration-model>development</configuration-model>
  </system>
</con:tc-config>