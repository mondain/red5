<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<beans>
	
	<bean id="placeholderConfig" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
	    <property name="location" value="/WEB-INF/red5-web.properties" />
	</bean>
	
	<bean id="web.context" class="org.red5.server.Context" 
		autowire="byType" />
	
	<bean id="web.scope" class="org.red5.server.WebScope"
		 init-method="register">
		<property name="server" ref="red5.server" />
		<property name="parent" ref="global.scope" />
		<property name="context" ref="web.context" />
		<property name="handler" ref="web.handler" />
		<property name="contextPath" value="${webapp.contextPath}" />
		<property name="virtualHosts" value="${webapp.virtualHosts}" />
	</bean>
	

	<bean id="web.handler" 
	    class="org.red5.server.webapp.oflaDemo.Application" 
		singleton="true" />

<!-- 
	<bean id="web.handler" class="org.red5.server.script.rhino.RhinoScriptFactory">
		<constructor-arg value="classpath:applications/main.js" />
		<constructor-arg><value>org.red5.server.adapter.IApplication</value></constructor-arg>
		<property name="scriptContext" ref="script.context" />
	</bean>
 -->
<!-- 
    <bean id="demoService.service" 
	    class="org.red5.server.webapp.oflaDemo.DemoService" 
		singleton="true" />
 -->
	
	<bean id="demoService.service" class="org.red5.server.script.rhino.RhinoScriptFactory">
		<constructor-arg value="classpath:applications/demoservice.js" />
		<property name="scriptContext" ref="script.context" />
	</bean>
	
	
	<bean class="org.red5.server.script.ScriptFactoryPostProcessor"/>

	<bean id="calculator" class="org.red5.server.script.jruby.JRubyScriptFactory">
		<constructor-arg>
			<value>inline:
require 'java'

include_class 'org.springframework.scripting.Calculator'

class RubyCalculator &lt; Calculator

 def add(x, y)
    x + y
 end

end
			</value>
		</constructor-arg>
		<constructor-arg value="org.springframework.scripting.Calculator"/>
	</bean>

	<bean id="messenger" class="org.red5.server.script.jruby.JRubyScriptFactory">
		<constructor-arg value="classpath:org/springframework/scripting/jruby/Messenger.rb"/>
		<constructor-arg value="org.springframework.scripting.Messenger"/>
		<property name="message" value="Hello World!"/>
	</bean>		
		
</beans>
